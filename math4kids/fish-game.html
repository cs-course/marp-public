<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é±¼è§…é£Ÿå¤§æŒ‘æˆ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background: linear-gradient(180deg, #87CEEB 0%, #4A90E2 50%, #2E5C8A 100%);
            min-height: 100vh;
            position: relative;
        }

        /* æµ·åº•æ³¢çº¹åŠ¨ç”» */
        .wave {
            position: absolute;
            width: 200%;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: wave 3s ease-in-out infinite;
        }

        .wave:nth-child(1) {
            top: 20%;
            animation-delay: 0s;
        }

        .wave:nth-child(2) {
            top: 40%;
            animation-delay: 1s;
        }

        .wave:nth-child(3) {
            top: 60%;
            animation-delay: 2s;
        }

        @keyframes wave {
            0%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            50% {
                transform: translateX(-50%) translateY(-20px);
            }
        }

        /* æ³¡æ³¡åŠ¨ç”» */
        .bubble {
            position: absolute;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: bubble 4s ease-in-out infinite;
        }

        @keyframes bubble {
            0% {
                transform: translateY(100vh) scale(1);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0.5);
                opacity: 0;
            }
        }

        /* å¼€å§‹æŒ‰é’® */
        #startBtn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            font-size: 24px;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            z-index: 100;
        }

        #startBtn:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        /* ä¸»è§’å°é±¼ */
        #playerFish {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            transition: all 0.5s;
        }

        /* å°ºå¯¸ç­‰çº§ */
        #playerFish.scale-1 {
            transform: translateX(-50%) scale(1.0);
        }

        #playerFish.scale-2 {
            transform: translateX(-50%) scale(1.1);
        }

        #playerFish.scale-3 {
            transform: translateX(-50%) scale(1.2);
        }

        #playerFish.scale-4 {
            transform: translateX(-50%) scale(1.3);
        }

        #playerFish.scale-5 {
            transform: translateX(-50%) scale(1.4);
        }

        #playerFish.scale-6 {
            transform: translateX(-50%) scale(1.5);
        }

        #playerFish.scale-7 {
            transform: translateX(-50%) scale(1.6);
        }

        .fish-body {
            width: 80px;
            height: 50px;
            background: #FF6B6B;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
            animation: fishSwim 2s ease-in-out infinite;
        }

        .fish-eye {
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            top: 12px;
            right: 15px;
        }

        .fish-eye::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: black;
            border-radius: 50%;
            top: 3px;
            right: 2px;
        }

        /* å°é±¼å˜´å·´ */
        .fish-mouth {
            position: absolute;
            width: 10px;
            height: 5px;
            background: transparent;
            border: 3px solid #333;
            border-top: none;
            border-radius: 0 0 10px 10px;
            top: 30px;
            right: 8px;
            transition: all 0.3s;
        }

        /* å¼€å¿ƒè¡¨æƒ… */
        .fish.happy .fish-mouth {
            width: 15px;
            height: 8px;
            border-radius: 0 0 15px 15px;
            top: 28px;
            right: 5px;
            animation: happyMouth 0.5s ease-in-out;
        }

        .fish.happy .fish-eye::after {
            animation: happyEye 0.5s ease-in-out;
        }

        @keyframes happyMouth {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.3);
            }
        }

        @keyframes happyEye {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        .fish-tail {
            position: absolute;
            left: -20px;
            top: 15px;
            width: 0;
            height: 0;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            border-right: 25px solid #FF6B6B;
            animation: tailWag 0.5s ease-in-out infinite;
        }

        .fish-fin {
            position: absolute;
            width: 20px;
            height: 15px;
            background: #FF6B6B;
            border-radius: 50% 50% 0 0;
            top: -10px;
            left: 30px;
            transform: rotate(-30deg);
        }

        /* èƒ½é‡å€¼æ˜¾ç¤º */
        #energyDisplay {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #2E5C8A;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        /* èƒ½é‡è™¾ */
        .shrimp {
            position: absolute;
            cursor: pointer;
            z-index: 30;
            transition: all 0.3s;
        }

        .shrimp-body {
            width: 50px;
            height: 30px;
            background: #FFB347;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        .shrimp-tail {
            position: absolute;
            right: -15px;
            top: 5px;
            width: 0;
            height: 0;
            border-left: 20px solid #FFB347;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
        }

        .shrimp-antenna {
            position: absolute;
            left: 10px;
            top: -15px;
            width: 2px;
            height: 20px;
            background: #FFB347;
            transform: rotate(-30deg);
        }

        .shrimp-antenna:nth-child(2) {
            left: 20px;
            transform: rotate(30deg);
        }

        /* éš¾åº¦ç­‰çº§2 - ä¸­ç­‰å¤§å° */
        .shrimp.difficulty-2 {
            transform: scale(1.3);
        }

        .shrimp.difficulty-2 .shrimp-body {
            background: #FFA500;
        }

        .shrimp.difficulty-2 .shrimp-tail {
            border-left-color: #FFA500;
        }

        .shrimp.difficulty-2 .shrimp-antenna {
            background: #FFA500;
        }

        /* éš¾åº¦ç­‰çº§3 - æœ€å¤§ */
        .shrimp.difficulty-3 {
            transform: scale(1.6);
        }

        .shrimp.difficulty-3 .shrimp-body {
            background: #FF8C00;
        }

        .shrimp.difficulty-3 .shrimp-tail {
            border-left-color: #FF8C00;
        }

        .shrimp.difficulty-3 .shrimp-antenna {
            background: #FF8C00;
        }

        .shrimp:hover {
            transform: scale(1.1);
        }

        .shrimp.difficulty-2:hover {
            transform: scale(1.4);
        }

        .shrimp.difficulty-3:hover {
            transform: scale(1.7);
        }

        /* ç­”é¢˜å¼¹çª— */
        #answerModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 200;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .question {
            font-size: 28px;
            margin-bottom: 20px;
            color: #2E5C8A;
        }

        .answer-input {
            width: 150px;
            padding: 10px;
            font-size: 24px;
            text-align: center;
            border: 3px solid #4A90E2;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .numpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .num-btn {
            padding: 15px;
            font-size: 24px;
            background: #4A90E2;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .num-btn:hover {
            background: #2E5C8A;
        }

        .num-btn:active {
            transform: scale(0.95);
        }

        .submit-btn {
            padding: 15px 40px;
            font-size: 20px;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 30px;
            cursor: pointer;
            color: #999;
        }

        /* æç¤ºä¿¡æ¯ */
        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            z-index: 300;
            animation: feedback 1.5s ease-in-out forwards;
        }

        .feedback.correct {
            background: #4CAF50;
            color: white;
        }

        .feedback.wrong {
            background: #F44336;
            color: white;
        }

        .feedback.tip {
            background: #FF9800;
            color: white;
            font-size: 18px;
        }

        @keyframes feedback {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        /* è§£é”æç¤º */
        .unlock {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px 50px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            border-radius: 20px;
            font-size: 28px;
            font-weight: bold;
            z-index: 400;
            animation: unlock 2s ease-in-out forwards;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
        }

        @keyframes unlock {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3);
            }
            30% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* å°é±¼çš®è‚¤ */
        .skin-rainbow .fish-body {
            background: linear-gradient(90deg, #FF6B6B, #FFB347, #4CAF50, #2196F3, #9C27B0);
        }

        .skin-rainbow .fish-tail {
            border-right-color: #9C27B0;
        }

        .skin-rainbow .fish-fin {
            background: #9C27B0;
        }

        .skin-spotted .fish-body {
            background: #4CAF50;
            position: relative;
        }

        .skin-spotted .fish-body::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, #2196F3 5px, transparent 5px);
            background-size: 20px 20px;
            border-radius: inherit;
        }

        .skin-spotted .fish-tail {
            border-right-color: #2196F3;
        }

        .skin-spotted .fish-fin {
            background: #2196F3;
        }

        /* é‡‘è‰²é±¼ - å‘å…‰æ•ˆæœ */
        .skin-gold .fish-body {
            background: linear-gradient(135deg, #FFD700, #FFA500, #FF8C00, #FFD700);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6), 0 0 40px rgba(255, 215, 0, 0.4);
            animation: goldShimmer 2s ease-in-out infinite;
        }

        .skin-gold .fish-tail {
            border-right-color: #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .skin-gold .fish-fin {
            background: #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        @keyframes goldShimmer {
            0%, 100% {
                filter: brightness(1);
            }
            50% {
                filter: brightness(1.3);
            }
        }

        /* é’»çŸ³é±¼ - é’»çŸ³å…‰æ³½+é—ªçƒ */
        .skin-diamond .fish-body {
            background: linear-gradient(135deg, #E0FFFF, #B0E0E6, #87CEEB, #E0FFFF);
            box-shadow: 0 0 15px rgba(224, 255, 255, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.5);
            animation: diamondSparkle 1.5s ease-in-out infinite;
        }

        .skin-diamond .fish-body::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.8) 50%, transparent 70%);
            border-radius: inherit;
            animation: diamondShine 2s ease-in-out infinite;
        }

        .skin-diamond .fish-tail {
            border-right-color: #E0FFFF;
            box-shadow: 0 0 10px rgba(224, 255, 255, 0.6);
        }

        .skin-diamond .fish-fin {
            background: #E0FFFF;
            box-shadow: 0 0 10px rgba(224, 255, 255, 0.6);
        }

        @keyframes diamondSparkle {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.85;
            }
        }

        @keyframes diamondShine {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* ä¼ å¥‡é±¼ - æ‰€æœ‰æ•ˆæœ+ç‰¹æ®ŠåŠ¨ç”» */
        .skin-legendary .fish-body {
            background: linear-gradient(90deg, #FF6B6B, #FFD700, #4CAF50, #2196F3, #9C27B0, #FF6B6B);
            background-size: 300% 100%;
            animation: legendaryBody 3s linear infinite, legendaryPulse 1.5s ease-in-out infinite;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 60px rgba(156, 39, 176, 0.5);
            position: relative;
        }

        .skin-legendary .fish-body::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, #FFD700 3px, transparent 3px);
            background-size: 15px 15px;
            border-radius: inherit;
            animation: starTwinkle 1s ease-in-out infinite;
        }

        .skin-legendary .fish-tail {
            border-right-color: #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: legendaryTail 0.3s ease-in-out infinite;
        }

        .skin-legendary .fish-fin {
            background: linear-gradient(135deg, #FFD700, #9C27B0);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }

        @keyframes legendaryBody {
            0% {
                background-position: 0% 50%;
            }
            100% {
                background-position: 300% 50%;
            }
        }

        @keyframes legendaryPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes starTwinkle {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        @keyframes legendaryTail {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(15deg);
            }
        }

        @keyframes fishSwim {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes tailWag {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(10deg);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .question {
                font-size: 22px;
            }

            .answer-input {
                width: 120px;
                font-size: 20px;
            }

            .num-btn {
                padding: 12px;
                font-size: 20px;
            }

            .fish-body {
                width: 60px;
                height: 38px;
            }

            .shrimp-body {
                width: 40px;
                height: 24px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- æ³¢çº¹æ•ˆæœ -->
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>

    <!-- æ³¡æ³¡å®¹å™¨ -->
    <div id="bubbles"></div>

    <!-- å¼€å§‹æŒ‰é’® -->
    <button id="startBtn">å¼€å§‹æ¸¸æˆ</button>

    <!-- ä¸»è§’å°é±¼ -->
    <div id="playerFish" class="fish">
        <div id="energyDisplay">èƒ½é‡: 0</div>
        <div class="fish-body">
            <div class="fish-eye"></div>
            <div class="fish-mouth"></div>
            <div class="fish-tail"></div>
            <div class="fish-fin"></div>
        </div>
    </div>

    <!-- èƒ½é‡è™¾å®¹å™¨ -->
    <div id="shrimps"></div>

    <!-- ç­”é¢˜å¼¹çª— -->
    <div id="answerModal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="question" id="questionText">358 + 276 = ?</div>
            <input type="text" class="answer-input" id="answerInput" readonly>
            <div class="numpad">
                <button class="num-btn" data-num="1">1</button>
                <button class="num-btn" data-num="2">2</button>
                <button class="num-btn" data-num="3">3</button>
                <button class="num-btn" data-num="4">4</button>
                <button class="num-btn" data-num="5">5</button>
                <button class="num-btn" data-num="6">6</button>
                <button class="num-btn" data-num="7">7</button>
                <button class="num-btn" data-num="8">8</button>
                <button class="num-btn" data-num="9">9</button>
                <button class="num-btn" data-num="clear">æ¸…é™¤</button>
                <button class="num-btn" data-num="0">0</button>
                <button class="num-btn" data-num="back">â†</button>
            </div>
            <button class="submit-btn" id="submitBtn">æäº¤ç­”æ¡ˆ</button>
        </div>
    </div>

    <script>
        // é¢˜åº“ - æŒ‰éš¾åº¦é€’è¿›æ’åˆ—
        // ç¬¬ä¸€é˜¶æ®µï¼ˆ1-10é¢˜ï¼‰ï¼šäºŒå¹´çº§åŸºç¡€ - 100ä»¥å†…ä¸è¿›ä½/ä¸é€€ä½åŠ å‡æ³•ã€è¡¨å†…ä¹˜æ³• - éš¾åº¦ç­‰çº§1
        // ç¬¬äºŒé˜¶æ®µï¼ˆ11-20é¢˜ï¼‰ï¼šäºŒå¹´çº§è¿›é˜¶ - 100ä»¥å†…è¿›ä½/é€€ä½åŠ å‡æ³•ã€ç®€å•ä¹˜æ³• - éš¾åº¦ç­‰çº§2
        // ç¬¬ä¸‰é˜¶æ®µï¼ˆ21-30é¢˜ï¼‰ï¼šä¸‰å¹´çº§ä¸Šå­¦æœŸ - ä¸‡ä»¥å†…åŠ å‡æ³•ã€å¤šä½æ•°ä¹˜ä¸€ä½æ•° - éš¾åº¦ç­‰çº§3
        const questionBank = [
            // ç¬¬ä¸€é˜¶æ®µï¼šäºŒå¹´çº§åŸºç¡€ï¼ˆ1-10é¢˜ï¼‰- éš¾åº¦ç­‰çº§1
            { question: "23 + 45", answer: 68, tip: "ä¸ªä½å’Œåä½åˆ†åˆ«ç›¸åŠ ", difficulty: 1 },
            { question: "78 - 32", answer: 46, tip: "ä¸ªä½å’Œåä½åˆ†åˆ«ç›¸å‡", difficulty: 1 },
            { question: "56 + 34", answer: 90, tip: "æ³¨æ„å¯¹é½æ•°ä½", difficulty: 1 },
            { question: "87 - 54", answer: 33, tip: "ä»ä¸ªä½å¼€å§‹å‡", difficulty: 1 },
            { question: "3 Ã— 7", answer: 21, tip: "ç”¨ä¹˜æ³•å£è¯€", difficulty: 1 },
            { question: "4 Ã— 8", answer: 32, tip: "ç”¨ä¹˜æ³•å£è¯€", difficulty: 1 },
            { question: "6 Ã— 9", answer: 54, tip: "ç”¨ä¹˜æ³•å£è¯€", difficulty: 1 },
            { question: "5 Ã— 7", answer: 35, tip: "ç”¨ä¹˜æ³•å£è¯€", difficulty: 1 },
            { question: "23 Ã— 2", answer: 46, tip: "åˆ†åˆ«ç”¨2å»ä¹˜ä¸ªä½å’Œåä½", difficulty: 1 },
            { question: "32 Ã— 3", answer: 96, tip: "åˆ†åˆ«ç”¨3å»ä¹˜ä¸ªä½å’Œåä½", difficulty: 1 },

            // ç¬¬äºŒé˜¶æ®µï¼šäºŒå¹´çº§è¿›é˜¶ï¼ˆ11-20é¢˜ï¼‰- éš¾åº¦ç­‰çº§2
            { question: "47 + 38", answer: 85, tip: "ä¸ªä½æ»¡åè¦è¿›ä½", difficulty: 2 },
            { question: "65 - 28", answer: 37, tip: "ä¸ªä½ä¸å¤Ÿå‡è¦å€Ÿä½", difficulty: 2 },
            { question: "56 + 49", answer: 105, tip: "ç»“æœæ˜¯ä¸‰ä½æ•°", difficulty: 2 },
            { question: "72 - 37", answer: 35, tip: "åä½ä¹Ÿè¦å€Ÿä½", difficulty: 2 },
            { question: "38 + 45", answer: 83, tip: "æ³¨æ„è¿›ä½", difficulty: 2 },
            { question: "81 - 26", answer: 55, tip: "ä»ä¸ªä½å¼€å§‹å‡", difficulty: 2 },
            { question: "27 Ã— 3", answer: 81, tip: "ä¸ªä½æ»¡åè¦è¿›ä½", difficulty: 2 },
            { question: "45 Ã— 2", answer: 90, tip: "åˆ†åˆ«ä¹˜ä¸ªä½å’Œåä½", difficulty: 2 },
            { question: "63 + 29", answer: 92, tip: "æ£€æŸ¥è¿›ä½", difficulty: 2 },
            { question: "94 - 38", answer: 56, tip: "è¿ç»­å€Ÿä½è¦å°å¿ƒ", difficulty: 2 },

            // ç¬¬ä¸‰é˜¶æ®µï¼šä¸‰å¹´çº§ä¸Šå­¦æœŸï¼ˆ21-30é¢˜ï¼‰- éš¾åº¦ç­‰çº§3
            { question: "358 + 276", answer: 634, tip: "æ³¨æ„è¿ç»­è¿›ä½", difficulty: 3 },
            { question: "723 - 456", answer: 267, tip: "æ³¨æ„å€Ÿä½", difficulty: 3 },
            { question: "205 Ã— 4", answer: 820, tip: "è®°ä½ä¸­é—´çš„0ä¹Ÿè¦ä¹˜", difficulty: 3 },
            { question: "456 + 389", answer: 845, tip: "ä¸ªä½è¿›ä½ååä½å†è¿›ä½", difficulty: 3 },
            { question: "812 - 397", answer: 415, tip: "è¿ç»­å€Ÿä½è¦å°å¿ƒ", difficulty: 3 },
            { question: "156 Ã— 3", answer: 468, tip: "æ³¨æ„è¿›ä½", difficulty: 3 },
            { question: "678 + 234", answer: 912, tip: "æ£€æŸ¥æ¯ä¸€ä½çš„è¿›ä½", difficulty: 3 },
            { question: "901 - 567", answer: 334, tip: "ç™¾ä½è¦å€Ÿä½", difficulty: 3 },
            { question: "178 Ã— 4", answer: 712, tip: "æ³¨æ„è¿›ä½", difficulty: 3 },
            { question: "654 + 327", answer: 981, tip: "æ£€æŸ¥è¿›ä½", difficulty: 3 }
        ];

        // æ¸¸æˆçŠ¶æ€
        let energy = 0;
        let currentQuestion = null;
        let currentShrimp = null;
        let gameStarted = false;
        let currentQuestionIndex = 0; // å½“å‰é¢˜ç›®ç´¢å¼•ï¼Œç”¨äºéš¾åº¦é€’è¿›

        // DOMå…ƒç´ 
        const startBtn = document.getElementById('startBtn');
        const playerFish = document.getElementById('playerFish');
        const energyDisplay = document.getElementById('energyDisplay');
        const shrimpsContainer = document.getElementById('shrimps');
        const answerModal = document.getElementById('answerModal');
        const questionText = document.getElementById('questionText');
        const answerInput = document.getElementById('answerInput');
        const submitBtn = document.getElementById('submitBtn');
        const closeBtn = document.querySelector('.close-btn');

        // éŸ³æ•ˆï¼ˆä½¿ç”¨Web Audio APIç”Ÿæˆç®€å•éŸ³æ•ˆï¼‰
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (type === 'correct') {
                oscillator.frequency.value = 523.25; // C5
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'wrong') {
                oscillator.frequency.value = 196; // G3
                oscillator.type = 'sawtooth';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'unlock') {
                oscillator.frequency.value = 659.25; // E5
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }

        // åˆ›å»ºæ³¡æ³¡
        function createBubbles() {
            const bubblesContainer = document.getElementById('bubbles');
            for (let i = 0; i < 10; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.style.left = Math.random() * 100 + '%';
                bubble.style.animationDelay = Math.random() * 4 + 's';
                bubble.style.animationDuration = (3 + Math.random() * 2) + 's';
                bubblesContainer.appendChild(bubble);
            }
        }

        // åˆ›å»ºèƒ½é‡è™¾
        function createShrimp() {
            if (!gameStarted) return;

            const shrimp = document.createElement('div');
            shrimp.className = 'shrimp';

            // æŒ‰é¡ºåºä»é¢˜åº“ä¸­å–é¢˜ï¼Œå®ç°éš¾åº¦é€’è¿›
            const question = questionBank[currentQuestionIndex];
            shrimp.dataset.question = JSON.stringify(question);

            // æ ¹æ®éš¾åº¦ç­‰çº§æ·»åŠ å¯¹åº”çš„class
            shrimp.classList.add(`difficulty-${question.difficulty}`);

            // æ›´æ–°é¢˜ç›®ç´¢å¼•ï¼Œå¾ªç¯ä½¿ç”¨é¢˜åº“
            currentQuestionIndex = (currentQuestionIndex + 1) % questionBank.length;

            const body = document.createElement('div');
            body.className = 'shrimp-body';
            body.textContent = '?';

            const tail = document.createElement('div');
            tail.className = 'shrimp-tail';

            const antenna1 = document.createElement('div');
            antenna1.className = 'shrimp-antenna';

            const antenna2 = document.createElement('div');
            antenna2.className = 'shrimp-antenna';

            shrimp.appendChild(antenna1);
            shrimp.appendChild(antenna2);
            shrimp.appendChild(body);
            shrimp.appendChild(tail);

            // éšæœºä½ç½®
            const maxX = window.innerWidth - 100;
            const maxY = window.innerHeight - 200;
            shrimp.style.left = Math.random() * maxX + 'px';
            shrimp.style.top = Math.random() * maxY + 'px';

            // éšæœºæ¸¸åŠ¨åŠ¨ç”»
            const duration = 5 + Math.random() * 5;
            const delay = Math.random() * 2;
            shrimp.style.animation = `shrimpSwim ${duration}s ease-in-out ${delay}s infinite`;

            // ç‚¹å‡»äº‹ä»¶
            shrimp.addEventListener('click', () => openQuestionModal(shrimp));

            shrimpsContainer.appendChild(shrimp);

            // é™åˆ¶è™¾çš„æ•°é‡
            if (shrimpsContainer.children.length > 5) {
                shrimpsContainer.removeChild(shrimpsContainer.firstChild);
            }
        }

        // æ‰“å¼€ç­”é¢˜å¼¹çª—
        function openQuestionModal(shrimp) {
            currentShrimp = shrimp;
            const questionData = JSON.parse(shrimp.dataset.question);
            currentQuestion = questionData;

            questionText.textContent = questionData.question + ' = ?';
            answerInput.value = '';
            answerModal.style.display = 'flex';
        }

        // å…³é—­ç­”é¢˜å¼¹çª—
        function closeAnswerModal() {
            answerModal.style.display = 'none';
            currentQuestion = null;
            currentShrimp = null;
        }

        // æ˜¾ç¤ºåé¦ˆ
        function showFeedback(type, message) {
            const feedback = document.createElement('div');
            feedback.className = `feedback ${type}`;
            feedback.textContent = message;
            document.body.appendChild(feedback);

            setTimeout(() => {
                feedback.remove();
            }, 1500);
        }

        // æ˜¾ç¤ºè§£é”æç¤º
        function showUnlockMessage(skinName) {
            const unlock = document.createElement('div');
            unlock.className = 'unlock';
            unlock.textContent = `ğŸ‰ è§£é”æ–°çš®è‚¤ï¼š${skinName}ï¼`;
            document.body.appendChild(unlock);

            setTimeout(() => {
                unlock.remove();
            }, 2000);
        }

        // æ›´æ–°èƒ½é‡å€¼
        function updateEnergy() {
            energyDisplay.textContent = `èƒ½é‡: ${energy}`;

            // æ¸…é™¤æ‰€æœ‰çš®è‚¤å’Œå°ºå¯¸ç±»
            playerFish.classList.remove(
                'skin-rainbow', 'skin-spotted', 'skin-gold', 'skin-diamond', 'skin-legendary',
                'scale-1', 'scale-2', 'scale-3', 'scale-4', 'scale-5', 'scale-6', 'scale-7'
            );

            // è®¡ç®—å½“å‰ç­‰çº§ï¼ˆæ¯5åˆ†å‡ä¸€çº§ï¼‰
            const level = Math.floor(energy / 5) + 1;

            // åº”ç”¨å¯¹åº”çš„çš®è‚¤å’Œå°ºå¯¸
            switch (level) {
                case 1: // 0-4åˆ†ï¼šåˆå§‹å°é±¼
                    playerFish.classList.add('scale-1');
                    break;
                case 2: // 5-9åˆ†ï¼šå½©è™¹é±¼
                    playerFish.classList.add('skin-rainbow', 'scale-2');
                    if (energy === 5) {
                        showUnlockMessage('å½©è™¹é±¼');
                        playSound('unlock');
                    }
                    break;
                case 3: // 10-14åˆ†ï¼šæ–‘ç‚¹é±¼
                    playerFish.classList.add('skin-spotted', 'scale-3');
                    if (energy === 10) {
                        showUnlockMessage('æ–‘ç‚¹é±¼');
                        playSound('unlock');
                    }
                    break;
                case 4: // 15-19åˆ†ï¼šå½©è™¹æ–‘ç‚¹é±¼
                    playerFish.classList.add('skin-rainbow', 'skin-spotted', 'scale-4');
                    if (energy === 15) {
                        showUnlockMessage('å½©è™¹æ–‘ç‚¹é±¼');
                        playSound('unlock');
                    }
                    break;
                case 5: // 20-24åˆ†ï¼šé‡‘è‰²é±¼
                    playerFish.classList.add('skin-gold', 'scale-5');
                    if (energy === 20) {
                        showUnlockMessage('é‡‘è‰²é±¼');
                        playSound('unlock');
                    }
                    break;
                case 6: // 25-29åˆ†ï¼šé’»çŸ³é±¼
                    playerFish.classList.add('skin-diamond', 'scale-6');
                    if (energy === 25) {
                        showUnlockMessage('é’»çŸ³é±¼');
                        playSound('unlock');
                    }
                    break;
                default: // 30åˆ†åŠä»¥ä¸Šï¼šä¼ å¥‡é±¼
                    playerFish.classList.add('skin-legendary', 'scale-7');
                    if (energy === 30) {
                        showUnlockMessage('ä¼ å¥‡é±¼');
                        playSound('unlock');
                    }
                    break;
            }
        }

        // æäº¤ç­”æ¡ˆ
        function submitAnswer() {
            const userAnswer = parseInt(answerInput.value);

            if (isNaN(userAnswer)) {
                showFeedback('wrong', 'è¯·è¾“å…¥æ•°å­—ï¼');
                return;
            }

            if (userAnswer === currentQuestion.answer) {
                // ç­”å¯¹
                playSound('correct');
                showFeedback('correct', 'çœŸæ£’ï¼');
                energy++;
                updateEnergy();

                // å¦‚æœæ˜¯éš¾é¢˜ï¼ˆéš¾åº¦ç­‰çº§2æˆ–3ï¼‰ï¼Œæ˜¾ç¤ºå¼€å¿ƒè¡¨æƒ…
                if (currentQuestion.difficulty >= 2) {
                    showHappyExpression();
                }

                // ç§»é™¤è™¾
                if (currentShrimp) {
                    currentShrimp.remove();
                }

                closeAnswerModal();
            } else {
                // ç­”é”™
                playSound('wrong');
                showFeedback('wrong', currentQuestion.tip);
                answerInput.value = '';
            }
        }

        // æ˜¾ç¤ºå¼€å¿ƒè¡¨æƒ…
        function showHappyExpression() {
            playerFish.classList.add('happy');

            // 1.5ç§’åç§»é™¤å¼€å¿ƒè¡¨æƒ…
            setTimeout(() => {
                playerFish.classList.remove('happy');
            }, 1500);
        }

        // æ•°å­—é”®ç›˜äº‹ä»¶
        document.querySelectorAll('.num-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const num = e.target.dataset.num;

                if (num === 'clear') {
                    answerInput.value = '';
                } else if (num === 'back') {
                    answerInput.value = answerInput.value.slice(0, -1);
                } else {
                    answerInput.value += num;
                }
            });
        });

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', () => {
            startBtn.style.display = 'none';
            gameStarted = true;

            // åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            // åˆ›å»ºåˆå§‹è™¾
            for (let i = 0; i < 3; i++) {
                setTimeout(() => createShrimp(), i * 1000);
            }

            // æŒç»­åˆ›å»ºè™¾
            setInterval(() => {
                if (gameStarted) {
                    createShrimp();
                }
            }, 3000);
        });

        submitBtn.addEventListener('click', submitAnswer);

        closeBtn.addEventListener('click', closeAnswerModal);

        answerModal.addEventListener('click', (e) => {
            if (e.target === answerModal) {
                closeAnswerModal();
            }
        });

        // é”®ç›˜æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            if (answerModal.style.display === 'flex') {
                if (e.key >= '0' && e.key <= '9') {
                    answerInput.value += e.key;
                } else if (e.key === 'Backspace') {
                    answerInput.value = answerInput.value.slice(0, -1);
                } else if (e.key === 'Enter') {
                    submitAnswer();
                } else if (e.key === 'Escape') {
                    closeAnswerModal();
                }
            }
        });

        // æ·»åŠ è™¾çš„æ¸¸åŠ¨åŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shrimpSwim {
                0% {
                    transform: translateX(0) translateY(0) rotate(0deg);
                }
                25% {
                    transform: translateX(50px) translateY(-30px) rotate(5deg);
                }
                50% {
                    transform: translateX(0) translateY(0) rotate(0deg);
                }
                75% {
                    transform: translateX(-50px) translateY(30px) rotate(-5deg);
                }
                100% {
                    transform: translateX(0) translateY(0) rotate(0deg);
                }
            }
        `;
        document.head.appendChild(style);

        // åˆå§‹åŒ–
        createBubbles();
    </script>
</body>
</html>