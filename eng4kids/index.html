<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é±¼å†²å…³å¤§å†’é™© - å°å­¦ä¸‰å¹´çº§è‹±è¯­å°æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Comic Sans MS', 'å¾®è½¯é›…é»‘', cursive;
            overflow: hidden;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F7FA 100%);
            min-height: 100vh;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        /* é¦–é¡µæ ·å¼ */
        #home-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(180deg, #FFB6C1 0%, #87CEEB 50%, #98FB98 100%);
            position: relative;
        }

        .home-title {
            font-size: 3.5rem;
            color: #FF69B4;
            text-shadow: 3px 3px 0 #FFF, 5px 5px 0 #FFD700;
            margin-bottom: 30px;
            animation: titleBounce 2s ease-in-out infinite;
        }

        @keyframes titleBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .fish-decoration {
            position: absolute;
            font-size: 3rem;
            animation: fishSwim 8s ease-in-out infinite;
        }

        .fish-decoration:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .fish-decoration:nth-child(2) { top: 20%; right: 15%; animation-delay: 2s; }
        .fish-decoration:nth-child(3) { bottom: 30%; left: 15%; animation-delay: 4s; }
        .fish-decoration:nth-child(4) { bottom: 20%; right: 10%; animation-delay: 6s; }

        @keyframes fishSwim {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(30px) rotate(5deg); }
            75% { transform: translateX(-30px) rotate(-5deg); }
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-pink {
            background: linear-gradient(135deg, #FF69B4, #FFB6C1);
            color: white;
        }

        .btn-blue {
            background: linear-gradient(135deg, #87CEEB, #4169E1);
            color: white;
        }

        .btn-green {
            background: linear-gradient(135deg, #98FB98, #32CD32);
            color: white;
        }

        .btn-yellow {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
        }

        .btn-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .difficulty-selector {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .difficulty-btn {
            padding: 10px 25px;
            font-size: 1.2rem;
            border: 3px solid;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .difficulty-btn.active {
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }

        .difficulty-btn.easy {
            border-color: #98FB98;
            color: #32CD32;
        }
        .difficulty-btn.easy.active {
            background: #98FB98;
            color: white;
        }

        .difficulty-btn.medium {
            border-color: #87CEEB;
            color: #4169E1;
        }
        .difficulty-btn.medium.active {
            background: #87CEEB;
            color: white;
        }

        .difficulty-btn.hard {
            border-color: #FFB6C1;
            color: #FF69B4;
        }
        .difficulty-btn.hard.active {
            background: #FFB6C1;
            color: white;
        }

        /* æ¸¸æˆå…³å¡æ ·å¼ */
        .game-screen {
            display: none;
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .game-screen.active {
            display: block;
        }

        .game-header {
            position: absolute;
            top: 10px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 100;
        }

        .game-title {
            font-size: 1.5rem;
            color: #FF69B4;
            font-weight: bold;
            text-shadow: 2px 2px 0 white;
        }

        .sound-control {
            font-size: 2rem;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.8);
            transition: all 0.3s ease;
        }

        .sound-control:hover {
            transform: scale(1.1);
            background: rgba(255,255,255,1);
        }

        .progress-bar {
            position: absolute;
            top: 60px;
            left: 20px;
            right: 20px;
            height: 8px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #98FB98, #FFD700, #FF69B4);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* ç¬¬ä¸€å…³ï¼šå•è¯è®¤è¯»è·³ç¤çŸ³ */
        #level1-screen {
            background: linear-gradient(180deg, #87CEEB 0%, #E0F7FA 100%);
        }

        .ocean-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .bubble {
            position: absolute;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            animation: bubbleFloat 8s ease-in-out infinite;
        }

        @keyframes bubbleFloat {
            0%, 100% { transform: translateY(0) scale(1); opacity: 0.6; }
            50% { transform: translateY(-100px) scale(1.1); opacity: 0.3; }
        }

        .sea-weed {
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 150px;
            background: linear-gradient(to top, #32CD32, #98FB98);
            border-radius: 50% 50% 0 0;
            transform-origin: bottom center;
            animation: weedWave 3s ease-in-out infinite;
        }

        @keyframes weedWave {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .fish-player {
            position: absolute;
            font-size: 4rem;
            transition: all 0.5s ease;
            z-index: 50;
            filter: drop-shadow(0 2px 10px rgba(0,0,0,0.3));
        }

        .fish-player.jumping {
            animation: fishJump 0.5s ease;
        }

        @keyframes fishJump {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-50px) scale(1.2); }
            100% { transform: translateY(0) scale(1); }
        }

        .reef {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 40;
        }

        .reef-icon {
            font-size: 3.5rem;
            filter: drop-shadow(0 3px 8px rgba(0,0,0,0.2));
        }

        .reef-text {
            font-size: 1.5rem;
            color: #FF69B4;
            font-weight: bold;
            text-shadow: 1px 1px 0 white;
            padding: 5px 10px;
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            margin-top: 5px;
        }

        .reef:hover {
            transform: scale(1.1);
        }

        .reef.correct {
            animation: reefCorrect 0.5s ease;
        }

        @keyframes reefCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1.1); }
        }

        .reef.wrong {
            animation: reefShake 0.5s ease;
        }

        @keyframes reefShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .word-display {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            padding: 20px 40px;
            border-radius: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .word-display h2 {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 10px;
        }

        .word-display .speak-btn {
            font-size: 1.5rem;
            cursor: pointer;
            margin-left: 10px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* ç¬¬äºŒå…³ï¼šå¥å‹å¡«ç©ºé¿æ¼©æ¶¡ */
        #level2-screen {
            background: linear-gradient(180deg, #4169E1 0%, #87CEEB 100%);
        }

        .whirlpool {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: radial-gradient(circle, #E0F7FA 0%, #4169E1 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(65, 105, 225, 0.5);
            animation: whirlpoolSpin 4s linear infinite;
        }

        @keyframes whirlpoolSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .whirlpool-text {
            position: absolute;
            font-size: 1.2rem;
            color: #FF69B4;
            font-weight: bold;
            text-shadow: 1px 1px 0 white;
            padding: 8px 15px;
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            text-align: center;
            max-width: 200px;
            z-index: 10;
        }

        .word-cards {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 100;
        }

        .word-card {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 1.5rem;
            color: white;
            font-weight: bold;
            cursor: grab;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            user-select: none;
        }

        .word-card:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .word-card.dragging {
            cursor: grabbing;
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
        }

        .word-card.correct {
            background: linear-gradient(135deg, #98FB98, #32CD32);
            animation: cardSuccess 0.5s ease;
        }

        @keyframes cardSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        /* ç¬¬ä¸‰å…³ï¼šçœ‹å›¾è¯´è¯å¼€è´å£³ */
        #level3-screen {
            background: linear-gradient(180deg, #FF69B4 0%, #FFD700 50%, #98FB98 100%);
        }

        .shell-grid {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 30px;
            padding: 30px;
            background: rgba(255,255,255,0.3);
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .shell {
            font-size: 4rem;
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 3px 10px rgba(0,0,0,0.2));
            position: relative;
        }

        .shell:hover {
            transform: scale(1.15) rotate(10deg);
        }

        .shell.open {
            animation: shellOpen 0.8s ease forwards;
        }

        @keyframes shellOpen {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.3) rotate(20deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .shell-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .shell.open .shell-image {
            opacity: 1;
        }

        .input-area {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            z-index: 100;
        }

        .word-input {
            background: white;
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 2rem;
            font-weight: bold;
            color: #4169E1;
            min-width: 300px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 3px solid #FFD700;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .key-btn {
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            color: white;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .key-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 12px rgba(0,0,0,0.3);
        }

        .key-btn:active {
            transform: scale(0.95);
        }

        .key-btn.action {
            background: linear-gradient(135deg, #87CEEB, #4169E1);
        }

        .key-btn.delete {
            background: linear-gradient(135deg, #FF6B6B, #FF4444);
        }

        .hint-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .hint-btn:hover {
            transform: scale(1.1);
        }

        /* é€šå…³ç•Œé¢ */
        .success-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .success-screen.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        .success-content {
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            padding: 40px 60px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .success-content h2 {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 20px;
            text-shadow: 2px 2px 0 #FFD700;
        }

        .success-content .fish-reward {
            font-size: 6rem;
            animation: rewardDance 1s ease-in-out infinite;
        }

        @keyframes rewardDance {
            0%, 100% { transform: rotate(-10deg) translateY(0); }
            50% { transform: rotate(10deg) translateY(-20px); }
        }

        .success-content p {
            font-size: 1.5rem;
            color: white;
            margin: 20px 0;
        }

        /* æˆ‘çš„å°é±¼ç¼¸ */
        #fish-tank-screen {
            background: linear-gradient(180deg, #87CEEB 0%, #4169E1 100%);
        }

        .tank-container {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 60%;
            background: linear-gradient(180deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
            border-radius: 30px;
            border: 5px solid rgba(255,255,255,0.5);
            overflow: hidden;
            position: relative;
        }

        .tank-fish {
            position: absolute;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .tank-fish:hover {
            transform: scale(1.2);
        }

        .tank-fish.swimming {
            animation: tankSwim 10s ease-in-out infinite;
        }

        @keyframes tankSwim {
            0%, 100% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(50px) translateY(-30px); }
            50% { transform: translateX(100px) translateY(0); }
            75% { transform: translateX(50px) translateY(30px); }
        }

        .tank-locked {
            font-size: 3rem;
            color: rgba(255,255,255,0.5);
            position: absolute;
        }

        .collection-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            padding: 15px 25px;
            border-radius: 20px;
            font-size: 1.3rem;
            color: #FF69B4;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* è¿”å›æŒ‰é’® */
        .back-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 10px 15px;
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-btn:hover {
            transform: scale(1.1);
            background: white;
        }

        /* æç¤ºä¿¡æ¯ */
        .hint-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 20px 40px;
            border-radius: 20px;
            font-size: 1.5rem;
            color: #FF69B4;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: hintPop 0.3s ease;
            display: none;
        }

        .hint-message.active {
            display: block;
        }

        @keyframes hintPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* å°æ°´æ€ª */
        .water-monster {
            position: absolute;
            font-size: 3rem;
            animation: monsterPop 1s ease forwards;
            z-index: 200;
        }

        @keyframes monsterPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .home-title {
                font-size: 2.5rem;
            }

            .btn {
                padding: 12px 30px;
                font-size: 1.2rem;
            }

            .difficulty-btn {
                padding: 8px 20px;
                font-size: 1rem;
            }

            .shell-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }

            .shell {
                font-size: 3rem;
            }

            .key-btn {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }

            .keyboard {
                grid-template-columns: repeat(7, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- é¦–é¡µ -->
        <div id="home-screen">
            <div class="fish-decoration">ğŸ </div>
            <div class="fish-decoration">ğŸŸ</div>
            <div class="fish-decoration">ğŸ¡</div>
            <div class="fish-decoration">ğŸ </div>
            
            <h1 class="home-title">å°é±¼å†²å…³å¤§å†’é™©</h1>
            
            <div class="difficulty-selector">
                <button class="difficulty-btn easy active" data-difficulty="easy">åˆçº§</button>
                <button class="difficulty-btn medium" data-difficulty="medium">è¿›é˜¶</button>
                <button class="difficulty-btn hard" data-difficulty="hard">ç»¼åˆ</button>
            </div>
            
            <div class="btn-container">
                <button class="btn btn-pink" id="start-btn">ğŸ® å¼€å§‹æ¸¸æˆ</button>
                <button class="btn btn-blue" id="fish-tank-btn">ğŸ  æˆ‘çš„å°é±¼ç¼¸ <span id="collection-count">0/3</span></button>
                <button class="sound-control" id="home-sound-btn">ğŸ”Š</button>
            </div>
        </div>

        <!-- ç¬¬ä¸€å…³ï¼šå•è¯è®¤è¯»è·³ç¤çŸ³ -->
        <div id="level1-screen" class="game-screen">
            <div class="game-header">
                <span class="game-title">ç¬¬ä¸€å…³ï¼šå•è¯è®¤è¯»è·³ç¤çŸ³</span>
                <span class="sound-control" id="level1-sound-btn">ğŸ”Š</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="level1-progress"></div>
            </div>
            
            <div class="ocean-bg" id="ocean-bg"></div>
            <div class="fish-player" id="fish-player">ğŸ </div>
            
            <div class="word-display">
                <h2 id="current-word">red</h2>
                <span class="speak-btn" id="speak-word-btn">ğŸ”Š</span>
            </div>
            
            <button class="back-btn" onclick="goHome()">â† è¿”å›</button>
        </div>

        <!-- ç¬¬äºŒå…³ï¼šå¥å‹å¡«ç©ºé¿æ¼©æ¶¡ -->
        <div id="level2-screen" class="game-screen">
            <div class="game-header">
                <span class="game-title">ç¬¬äºŒå…³ï¼šå¥å‹å¡«ç©ºé¿æ¼©æ¶¡</span>
                <span class="sound-control" id="level2-sound-btn">ğŸ”Š</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="level2-progress"></div>
            </div>
            
            <div class="ocean-bg" id="whirlpool-bg"></div>
            <div class="fish-player" id="fish-player2">ğŸŸ</div>
            
            <div id="whirlpool-container"></div>
            
            <div class="word-cards" id="word-cards-container"></div>
            
            <button class="back-btn" onclick="goHome()">â† è¿”å›</button>
        </div>

        <!-- ç¬¬ä¸‰å…³ï¼šçœ‹å›¾è¯´è¯å¼€è´å£³ -->
        <div id="level3-screen" class="game-screen">
            <div class="game-header">
                <span class="game-title">ç¬¬ä¸‰å…³ï¼šçœ‹å›¾è¯´è¯å¼€è´å£³</span>
                <span class="sound-control" id="level3-sound-btn">ğŸ”Š</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="level3-progress"></div>
            </div>
            
            <div class="shell-grid" id="shell-grid"></div>
            
            <div class="input-area">
                <div class="word-input" id="word-input">ç‚¹å‡»è´å£³å¼€å§‹æ‹¼å†™</div>
                <button class="hint-btn" id="hint-btn">ğŸ’¡ æç¤º</button>
                <div class="keyboard" id="keyboard"></div>
            </div>
            
            <button class="back-btn" onclick="goHome()">â† è¿”å›</button>
        </div>

        <!-- æˆ‘çš„å°é±¼ç¼¸ -->
        <div id="fish-tank-screen" class="game-screen">
            <div class="game-header">
                <span class="game-title">æˆ‘çš„å°é±¼ç¼¸</span>
            </div>
            
            <div class="collection-info">å·²æ”¶é›† <span id="tank-count">0</span>/3 æ¡å°é±¼</div>
            
            <div class="tank-container" id="tank-container">
                <div class="tank-fish swimming" id="fish1" style="left: 10%; top: 30%; display: none;">ğŸ </div>
                <div class="tank-fish swimming" id="fish2" style="left: 50%; top: 50%; display: none;">ğŸŸ</div>
                <div class="tank-fish swimming" id="fish3" style="left: 70%; top: 20%; display: none;">ğŸ¡</div>
                <div class="tank-locked" id="lock1" style="left: 10%; top: 30%;">ğŸ”’</div>
                <div class="tank-locked" id="lock2" style="left: 50%; top: 50%;">ğŸ”’</div>
                <div class="tank-locked" id="lock3" style="left: 70%; top: 20%;">ğŸ”’</div>
            </div>
            
            <button class="back-btn" onclick="goHome()">â† è¿”å›</button>
        </div>

        <!-- é€šå…³ç•Œé¢ -->
        <div class="success-screen" id="success-screen">
            <div class="success-content">
                <h2>å¤ªæ£’å•¦ï¼é€šå…³æˆåŠŸï¼ğŸ‰</h2>
                <div class="fish-reward" id="reward-fish">ğŸŸ</div>
                <p>è§£é”æ–°å°é±¼ï¼š<span id="reward-name">è“è‰²é•¿æ¡é±¼</span></p>
                <div class="btn-container">
                    <button class="btn btn-green" id="next-level-btn">ä¸‹ä¸€å…³ â¡ï¸</button>
                    <button class="btn btn-pink" id="replay-btn">é‡ç© ğŸ”„</button>
                    <button class="btn btn-blue" onclick="goHome()">è¿”å›é¦–é¡µ ğŸ </button>
                </div>
            </div>
        </div>

        <!-- æç¤ºä¿¡æ¯ -->
        <div class="hint-message" id="hint-message"></div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = {
            words: {
                easy: [
                    { en: 'red', cn: 'çº¢è‰²', emoji: 'ğŸ”´' },
                    { en: 'blue', cn: 'è“è‰²', emoji: 'ğŸ”µ' },
                    { en: 'green', cn: 'ç»¿è‰²', emoji: 'ğŸŸ¢' },
                    { en: 'yellow', cn: 'é»„è‰²', emoji: 'ğŸŸ¡' },
                    { en: 'one', cn: 'ä¸€', emoji: '1ï¸âƒ£' },
                    { en: 'two', cn: 'äºŒ', emoji: '2ï¸âƒ£' },
                    { en: 'three', cn: 'ä¸‰', emoji: '3ï¸âƒ£' },
                    { en: 'five', cn: 'äº”', emoji: '5ï¸âƒ£' },
                    { en: 'eight', cn: 'å…«', emoji: '8ï¸âƒ£' },
                    { en: 'ten', cn: 'å', emoji: 'ğŸ”Ÿ' }
                ],
                medium: [
                    { en: 'pencil', cn: 'é“…ç¬”', emoji: 'âœï¸' },
                    { en: 'book', cn: 'ä¹¦', emoji: 'ğŸ“š' },
                    { en: 'cat', cn: 'çŒ«', emoji: 'ğŸ±' },
                    { en: 'bird', cn: 'é¸Ÿ', emoji: 'ğŸ¦' },
                    { en: 'dog', cn: 'ç‹—', emoji: 'ğŸ•' },
                    { en: 'desk', cn: 'æ¡Œå­', emoji: 'ğŸª‘' },
                    { en: 'bag', cn: 'åŒ…', emoji: 'ğŸ‘œ' },
                    { en: 'pen', cn: 'é’¢ç¬”', emoji: 'ğŸ–Šï¸' },
                    { en: 'chair', cn: 'æ¤…å­', emoji: 'ğŸª‘' },
                    { en: 'ball', cn: 'çƒ', emoji: 'âš½' }
                ],
                hard: [
                    { en: 'apple', cn: 'è‹¹æœ', emoji: 'ğŸ' },
                    { en: 'orange', cn: 'æ©™å­', emoji: 'ğŸŠ' },
                    { en: 'banana', cn: 'é¦™è•‰', emoji: 'ğŸŒ' },
                    { en: 'school', cn: 'å­¦æ ¡', emoji: 'ğŸ«' },
                    { en: 'teacher', cn: 'è€å¸ˆ', emoji: 'ğŸ‘©â€ğŸ«' },
                    { en: 'student', cn: 'å­¦ç”Ÿ', emoji: 'ğŸ‘¨â€ğŸ“' },
                    { en: 'friend', cn: 'æœ‹å‹', emoji: 'ğŸ¤' },
                    { en: 'family', cn: 'å®¶åº­', emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' },
                    { en: 'happy', cn: 'å¿«ä¹', emoji: 'ğŸ˜Š' },
                    { en: 'love', cn: 'çˆ±', emoji: 'â¤ï¸' }
                ]
            },
            sentences: {
                easy: [
                    { en: 'I have a ______', answer: 'pen', options: ['pen', 'cat', 'red'], complete: 'I have a pen' },
                    { en: 'This is a ______', answer: 'book', options: ['book', 'dog', 'blue'], complete: 'This is a book' },
                    { en: 'I see a ______', answer: 'bird', options: ['bird', 'desk', 'green'], complete: 'I see a bird' },
                    { en: 'That is a ______', answer: 'cat', options: ['cat', 'pen', 'yellow'], complete: 'That is a cat' },
                    { en: 'It is a ______', answer: 'bag', options: ['bag', 'bird', 'two'], complete: 'It is a bag' }
                ],
                medium: [
                    { en: 'It is ______', answer: 'red', options: ['red', 'pen', 'cat'], complete: 'It is red' },
                    { en: 'The book is ______', answer: 'blue', options: ['blue', 'dog', 'pencil'], complete: 'The book is blue' },
                    { en: 'My cat is ______', answer: 'white', options: ['white', 'book', 'bird'], complete: 'My cat is white' },
                    { en: 'I see ______ birds', answer: 'five', options: ['five', 'red', 'desk'], complete: 'I see five birds' },
                    { en: 'There are ______ books', answer: 'eight', options: ['eight', 'blue', 'chair'], complete: 'There are eight books' }
                ],
                hard: [
                    { en: 'I see ______ apples', answer: 'five', options: ['five', 'red', 'pen'], complete: 'I see five apples' },
                    { en: 'The dog is ______', answer: 'brown', options: ['brown', 'book', 'three'], complete: 'The dog is brown' },
                    { en: 'My teacher is ______', answer: 'nice', options: ['nice', 'school', 'five'], complete: 'My teacher is nice' },
                    { en: 'We have ______ friends', answer: 'ten', options: ['ten', 'brown', 'nice'], complete: 'We have ten friends' },
                    { en: 'The banana is ______', answer: 'yellow', options: ['yellow', 'ten', 'nice'], complete: 'The banana is yellow' }
                ]
            },
            fishRewards: [
                { id: 1, name: 'è“è‰²é•¿æ¡é±¼', emoji: 'ğŸŸ', unlocked: false },
                { id: 2, name: 'é»„è‰²æ–‘ç‚¹é±¼', emoji: 'ğŸ¡', unlocked: false },
                { id: 3, name: 'ç²‰è‰²è´è¶ç»“é±¼', emoji: 'ğŸ ', unlocked: false }
            ]
        };

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            currentDifficulty: 'easy',
            currentLevel: 0,
            soundEnabled: true,
            unlockedFish: [],
            currentWords: [],
            currentIndex: 0,
            currentShells: [],
            currentInput: '',
            selectedShell: null
        };

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            loadProgress();
            setupEventListeners();
            updateCollectionCount();
            createKeyboard();
            createBubbles();
        }

        // åŠ è½½è¿›åº¦
        function loadProgress() {
            const saved = localStorage.getItem('fishAdventure');
            if (saved) {
                const data = JSON.parse(saved);
                gameState.unlockedFish = data.unlockedFish || [];
            }
            updateCollectionCount();
        }

        // ä¿å­˜è¿›åº¦
        function saveProgress() {
            localStorage.setItem('fishAdventure', JSON.stringify({
                unlockedFish: gameState.unlockedFish
            }));
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // é¦–é¡µæŒ‰é’®
            document.getElementById('start-btn').addEventListener('click', startGame);
            document.getElementById('fish-tank-btn').addEventListener('click', showFishTank);
            document.getElementById('home-sound-btn').addEventListener('click', toggleSound);

            // éš¾åº¦é€‰æ‹©
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    gameState.currentDifficulty = e.target.dataset.difficulty;
                });
            });

            // å…³å¡éŸ³æ•ˆæ§åˆ¶
            document.getElementById('level1-sound-btn').addEventListener('click', toggleSound);
            document.getElementById('level2-sound-btn').addEventListener('click', toggleSound);
            document.getElementById('level3-sound-btn').addEventListener('click', toggleSound);

            // ç¬¬ä¸€å…³
            document.getElementById('speak-word-btn').addEventListener('click', speakCurrentWord);

            // ç¬¬äºŒå…³
            document.getElementById('next-level-btn').addEventListener('click', nextLevel);
            document.getElementById('replay-btn').addEventListener('click', replayLevel);

            // ç¬¬ä¸‰å…³
            document.getElementById('hint-btn').addEventListener('click', showHint);
        }

        // åˆ›å»ºé”®ç›˜
        function createKeyboard() {
            const keyboard = document.getElementById('keyboard');
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            keyboard.innerHTML = '';
            letters.split('').forEach(letter => {
                const btn = document.createElement('button');
                btn.className = 'key-btn';
                btn.textContent = letter;
                btn.addEventListener('click', () => typeLetter(letter));
                keyboard.appendChild(btn);
            });

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'key-btn delete';
            deleteBtn.textContent = 'âŒ«';
            deleteBtn.addEventListener('click', deleteLetter);
            keyboard.appendChild(deleteBtn);

            const clearBtn = document.createElement('button');
            clearBtn.className = 'key-btn action';
            clearBtn.textContent = 'âœ“';
            clearBtn.addEventListener('click', submitWord);
            keyboard.appendChild(clearBtn);
        }

        // åˆ›å»ºæ°”æ³¡
        function createBubbles() {
            const oceanBg = document.getElementById('ocean-bg');
            for (let i = 0; i < 15; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.style.left = Math.random() * 100 + '%';
                bubble.style.top = Math.random() * 100 + '%';
                bubble.style.width = (Math.random() * 20 + 10) + 'px';
                bubble.style.height = bubble.style.width;
                bubble.style.animationDelay = Math.random() * 8 + 's';
                oceanBg.appendChild(bubble);
            }

            // æ·»åŠ æ°´è‰
            for (let i = 0; i < 8; i++) {
                const weed = document.createElement('div');
                weed.className = 'sea-weed';
                weed.style.left = (i * 12 + 5) + '%';
                weed.style.animationDelay = (i * 0.5) + 's';
                oceanBg.appendChild(weed);
            }
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            playSound('click');
            showScreen('level1-screen');
            gameState.currentLevel = 1;
            initLevel1();
        }

        // æ˜¾ç¤ºå±å¹•
        function showScreen(screenId) {
            // éšè—é¦–é¡µ
            document.getElementById('home-screen').style.display = 'none';
            // ç§»é™¤æ‰€æœ‰æ¸¸æˆå±å¹•çš„ active ç±»
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            // æ˜¾ç¤ºæŒ‡å®šçš„å±å¹•
            document.getElementById(screenId).classList.add('active');
        }

        // è¿”å›é¦–é¡µ
        function goHome() {
            playSound('click');
            showScreen('home-screen');
            document.getElementById('home-screen').style.display = 'flex';
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
        }

        // ç¬¬ä¸€å…³åˆå§‹åŒ–
        function initLevel1() {
            const words = [...gameData.words[gameState.currentDifficulty]];
            gameState.currentWords = shuffleArray(words).slice(0, 6);
            gameState.currentIndex = 0;

            createReefs();
            showCurrentWord();
        }

        // åˆ›å»ºç¤çŸ³
        function createReefs() {
            const level1Screen = document.getElementById('level1-screen');
            
            // æ¸…é™¤æ—§ç¤çŸ³
            document.querySelectorAll('.reef').forEach(r => r.remove());

            const containerWidth = window.innerWidth;
            const containerHeight = window.innerHeight;

            gameState.currentWords.forEach((word, index) => {
                const reef = document.createElement('div');
                reef.className = 'reef';
                reef.innerHTML = `
                    <div class="reef-icon">ğŸª¨</div>
                    <div class="reef-text">${word.cn}</div>
                `;
                
                // éšæœºä½ç½®
                const x = 100 + (containerWidth - 200) * (index / (gameState.currentWords.length - 1));
                const y = 200 + Math.random() * (containerHeight - 400);
                
                reef.style.left = x + 'px';
                reef.style.top = y + 'px';
                
                reef.addEventListener('click', () => checkReef(reef, word));
                level1Screen.appendChild(reef);
            });

            // è®¾ç½®å°é±¼åˆå§‹ä½ç½®
            const fish = document.getElementById('fish-player');
            fish.style.left = '20px';
            fish.style.top = (containerHeight / 2) + 'px';
        }

        // æ˜¾ç¤ºå½“å‰å•è¯
        function showCurrentWord() {
            if (gameState.currentIndex >= gameState.currentWords.length) {
                showSuccess(1);
                return;
            }

            const word = gameState.currentWords[gameState.currentIndex];
            document.getElementById('current-word').textContent = word.en;
            speakText(word.en);

            updateProgress(1, gameState.currentIndex + 1, gameState.currentWords.length);
        }

        // æ£€æŸ¥ç¤çŸ³ç‚¹å‡»
        function checkReef(reef, word) {
            const currentWord = gameState.currentWords[gameState.currentIndex];
            
            if (word.en === currentWord.en) {
                // æ­£ç¡®
                reef.classList.add('correct');
                moveFishToReef(reef);
                playSound('correct');
                
                setTimeout(() => {
                    gameState.currentIndex++;
                    showCurrentWord();
                }, 1000);
            } else {
                // é”™è¯¯
                reef.classList.add('wrong');
                playSound('wrong');
                showHintMessage('å””ï¼Œå†è¯•è¯•å§ï¼');
                
                setTimeout(() => {
                    reef.classList.remove('wrong');
                }, 500);
            }
        }

        // ç§»åŠ¨å°é±¼åˆ°ç¤çŸ³
        function moveFishToReef(reef) {
            const fish = document.getElementById('fish-player');
            const rect = reef.getBoundingClientRect();
            
            fish.classList.add('jumping');
            fish.style.left = (rect.left + rect.width / 2 - 30) + 'px';
            fish.style.top = (rect.top + rect.height / 2 - 30) + 'px';
            
            setTimeout(() => {
                fish.classList.remove('jumping');
            }, 500);
        }

        // æœ—è¯»å½“å‰å•è¯
        function speakCurrentWord() {
            const word = gameState.currentWords[gameState.currentIndex];
            if (word) {
                speakText(word.en);
            }
        }

        // ç¬¬äºŒå…³åˆå§‹åŒ–
        function initLevel2() {
            const sentences = [...gameData.sentences[gameState.currentDifficulty]];
            gameState.currentWords = shuffleArray(sentences).slice(0, 5);
            gameState.currentIndex = 0;

            createWhirlpools();
            createWordCards();
            updateProgress(2, 1, gameState.currentWords.length);
        }

        // åˆ›å»ºæ¼©æ¶¡
        function createWhirlpools() {
            const container = document.getElementById('whirlpool-container');
            container.innerHTML = '';

            const containerWidth = window.innerWidth;
            const containerHeight = window.innerHeight;

            gameState.currentWords.forEach((sentence, index) => {
                const whirlpool = document.createElement('div');
                whirlpool.className = 'whirlpool';
                whirlpool.id = `whirlpool-${index}`;
                
                const text = document.createElement('div');
                text.className = 'whirlpool-text';
                text.textContent = sentence.en;
                whirlpool.appendChild(text);

                // éšæœºä½ç½®
                const x = 150 + (containerWidth - 300) * ((index + 0.5) / gameState.currentWords.length);
                const y = 200 + Math.random() * (containerHeight - 400);
                
                whirlpool.style.left = x + 'px';
                whirlpool.style.top = y + 'px';

                container.appendChild(whirlpool);
            });

            // è®¾ç½®å°é±¼ä½ç½®
            const fish = document.getElementById('fish-player2');
            fish.style.left = '20px';
            fish.style.top = (containerHeight / 2) + 'px';
        }

        // åˆ›å»ºå•è¯å¡ç‰‡
        function createWordCards() {
            const container = document.getElementById('word-cards-container');
            container.innerHTML = '';

            const currentSentence = gameState.currentWords[gameState.currentIndex];
            const shuffledOptions = shuffleArray([...currentSentence.options]);

            shuffledOptions.forEach(option => {
                const card = document.createElement('div');
                card.className = 'word-card';
                card.textContent = option;
                card.draggable = true;

                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
                card.addEventListener('click', () => selectWordCard(card, option));

                container.appendChild(card);
            });

            // æœ—è¯»å¥å­
            speakText(currentSentence.en.replace('______', 'blank'));
        }

        // æ‹–æ‹½å¼€å§‹
        let draggedCard = null;
        let draggedWord = '';

        function handleDragStart(e) {
            draggedCard = e.target;
            draggedWord = e.target.textContent;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedCard = null;
        }

        // é€‰æ‹©å•è¯å¡ç‰‡ï¼ˆç‚¹å‡»æ–¹å¼ï¼‰
        function selectWordCard(card, word) {
            const currentSentence = gameState.currentWords[gameState.currentIndex];
            const whirlpool = document.getElementById(`whirlpool-${gameState.currentIndex}`);

            if (word === currentSentence.answer) {
                // æ­£ç¡®
                card.classList.add('correct');
                whirlpool.style.animation = 'none';
                whirlpool.style.opacity = '0';
                playSound('correct');
                speakText(currentSentence.complete);

                setTimeout(() => {
                    gameState.currentIndex++;
                    if (gameState.currentIndex >= gameState.currentWords.length) {
                        showSuccess(2);
                    } else {
                        createWordCards();
                        updateProgress(2, gameState.currentIndex + 1, gameState.currentWords.length);
                    }
                }, 1500);
            } else {
                // é”™è¯¯
                card.style.animation = 'reefShake 0.5s ease';
                playSound('wrong');
                showHintMessage('å””ï¼Œå†è¯•è¯•å§ï¼');
                
                setTimeout(() => {
                    card.style.animation = '';
                }, 500);
            }
        }

        // ç¬¬ä¸‰å…³åˆå§‹åŒ–
        function initLevel3() {
            const words = [...gameData.words[gameState.currentDifficulty]];
            gameState.currentWords = shuffleArray(words).slice(0, 10);
            gameState.currentShells = [];
            gameState.currentInput = '';
            gameState.selectedShell = null;

            createShells();
            updateProgress(3, 0, gameState.currentWords.length);
            document.getElementById('word-input').textContent = 'ç‚¹å‡»è´å£³å¼€å§‹æ‹¼å†™';
        }

        // åˆ›å»ºè´å£³
        function createShells() {
            const grid = document.getElementById('shell-grid');
            grid.innerHTML = '';

            gameState.currentWords.forEach((word, index) => {
                const shell = document.createElement('div');
                shell.className = 'shell';
                shell.id = `shell-${index}`;
                shell.innerHTML = 'ğŸš';

                const image = document.createElement('div');
                image.className = 'shell-image';
                image.textContent = word.emoji;
                shell.appendChild(image);

                shell.addEventListener('click', () => openShell(shell, word, index));
                grid.appendChild(shell);
            });
        }

        // æ‰“å¼€è´å£³
        function openShell(shell, word, index) {
            if (shell.classList.contains('open') || shell.classList.contains('completed')) {
                return;
            }

            shell.classList.add('open');
            gameState.selectedShell = index;
            gameState.currentInput = '';
            document.getElementById('word-input').textContent = '';

            speakText('What is this?');
        }

        // è¾“å…¥å­—æ¯
        function typeLetter(letter) {
            if (gameState.selectedShell === null) {
                showHintMessage('è¯·å…ˆç‚¹å‡»è´å£³ï¼');
                return;
            }

            const currentWord = gameState.currentWords[gameState.selectedShell];
            
            if (gameState.currentInput.length < currentWord.en.length) {
                gameState.currentInput += letter.toLowerCase();
                document.getElementById('word-input').textContent = gameState.currentInput;
                playSound('click');
            }
        }

        // åˆ é™¤å­—æ¯
        function deleteLetter() {
            if (gameState.currentInput.length > 0) {
                gameState.currentInput = gameState.currentInput.slice(0, -1);
                document.getElementById('word-input').textContent = gameState.currentInput || ' ';
                playSound('click');
            }
        }

        // æäº¤å•è¯
        function submitWord() {
            if (gameState.selectedShell === null) {
                showHintMessage('è¯·å…ˆç‚¹å‡»è´å£³ï¼');
                return;
            }

            const currentWord = gameState.currentWords[gameState.selectedShell];
            const shell = document.getElementById(`shell-${gameState.selectedShell}`);

            if (gameState.currentInput.toLowerCase() === currentWord.en.toLowerCase()) {
                // æ­£ç¡®
                shell.classList.add('completed');
                shell.innerHTML = currentWord.emoji + ' âœ…';
                playSound('correct');
                speakText(currentWord.en);

                // æ›´æ–°è¿›åº¦
                const completedCount = document.querySelectorAll('.shell.completed').length;
                updateProgress(3, completedCount, gameState.currentWords.length);

                // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨å®Œæˆ
                if (completedCount >= gameState.currentWords.length) {
                    setTimeout(() => {
                        showSuccess(3);
                    }, 1000);
                }

                // é‡ç½®è¾“å…¥
                gameState.selectedShell = null;
                gameState.currentInput = '';
                document.getElementById('word-input').textContent = 'ç‚¹å‡»è´å£³å¼€å§‹æ‹¼å†™';
            } else {
                // é”™è¯¯
                document.getElementById('word-input').style.animation = 'reefShake 0.5s ease';
                playSound('wrong');
                showHintMessage('å””ï¼Œæ‹¼å†™ä¸å¯¹å“¦ï¼');
                
                setTimeout(() => {
                    document.getElementById('word-input').style.animation = '';
                }, 500);
            }
        }

        // æ˜¾ç¤ºæç¤º
        function showHint() {
            if (gameState.selectedShell === null) {
                showHintMessage('è¯·å…ˆç‚¹å‡»è´å£³ï¼');
                return;
            }

            const currentWord = gameState.currentWords[gameState.selectedShell];
            if (gameState.currentInput.length < currentWord.en.length) {
                const nextLetter = currentWord.en[gameState.currentInput.length].toUpperCase();
                showHintMessage('æç¤ºï¼šä¸‹ä¸€ä¸ªå­—æ¯æ˜¯ ' + nextLetter);
                playSound('hint');
            }
        }

        // æ˜¾ç¤ºé€šå…³ç•Œé¢
        function showSuccess(level) {
            const reward = gameData.fishRewards[level - 1];
            
            if (!gameState.unlockedFish.includes(level)) {
                gameState.unlockedFish.push(level);
                saveProgress();
                updateCollectionCount();
            }

            document.getElementById('reward-fish').textContent = reward.emoji;
            document.getElementById('reward-name').textContent = reward.name;
            document.getElementById('success-screen').classList.add('active');
            
            playSound('success');
            speakText('Great job! You did it!');
        }

        // ä¸‹ä¸€å…³
        function nextLevel() {
            document.getElementById('success-screen').classList.remove('active');
            
            gameState.currentLevel++;
            
            if (gameState.currentLevel === 2) {
                showScreen('level2-screen');
                initLevel2();
            } else if (gameState.currentLevel === 3) {
                showScreen('level3-screen');
                initLevel3();
            } else {
                goHome();
            }
        }

        // é‡ç©å½“å‰å…³å¡
        function replayLevel() {
            document.getElementById('success-screen').classList.remove('active');
            
            if (gameState.currentLevel === 1) {
                initLevel1();
            } else if (gameState.currentLevel === 2) {
                initLevel2();
            } else if (gameState.currentLevel === 3) {
                initLevel3();
            }
        }

        // æ˜¾ç¤ºå°é±¼ç¼¸
        function showFishTank() {
            playSound('click');
            showScreen('fish-tank-screen');
            updateTankDisplay();
        }

        // æ›´æ–°å°é±¼ç¼¸æ˜¾ç¤º
        function updateTankDisplay() {
            for (let i = 1; i <= 3; i++) {
                const fish = document.getElementById(`fish${i}`);
                const lock = document.getElementById(`lock${i}`);
                
                if (gameState.unlockedFish.includes(i)) {
                    fish.style.display = 'block';
                    lock.style.display = 'none';
                } else {
                    fish.style.display = 'none';
                    lock.style.display = 'block';
                }
            }
            
            document.getElementById('tank-count').textContent = gameState.unlockedFish.length;
        }

        // æ›´æ–°æ”¶é›†è®¡æ•°
        function updateCollectionCount() {
            document.getElementById('collection-count').textContent = `${gameState.unlockedFish.length}/3`;
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(level, current, total) {
            const progress = document.getElementById(`level${level}-progress`);
            const percentage = (current / total) * 100;
            progress.style.width = percentage + '%';
        }

        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        function showHintMessage(message) {
            const hint = document.getElementById('hint-message');
            hint.textContent = message;
            hint.classList.add('active');
            
            setTimeout(() => {
                hint.classList.remove('active');
            }, 2000);
        }

        // åˆ‡æ¢éŸ³æ•ˆ
        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            const soundBtns = document.querySelectorAll('.sound-control');
            soundBtns.forEach(btn => {
                btn.textContent = gameState.soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
            });
        }

        // æ’­æ”¾éŸ³æ•ˆ
        function playSound(type) {
            if (!gameState.soundEnabled) return;

            // ä½¿ç”¨Web Audio APIåˆ›å»ºç®€å•éŸ³æ•ˆ
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            switch(type) {
                case 'click':
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.1;
                    break;
                case 'correct':
                    oscillator.frequency.value = 523.25;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.15;
                    break;
                case 'wrong':
                    oscillator.frequency.value = 200;
                    oscillator.type = 'square';
                    gainNode.gain.value = 0.1;
                    break;
                case 'success':
                    oscillator.frequency.value = 659.25;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.2;
                    break;
                case 'hint':
                    oscillator.frequency.value = 440;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.1;
                    break;
            }

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        // æ–‡å­—è½¬è¯­éŸ³
        function speakText(text) {
            if (!gameState.soundEnabled) return;

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.8;
            utterance.pitch = 1.2;
            speechSynthesis.speak(utterance);
        }

        // æ•°ç»„æ´—ç‰Œ
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', initGame);

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°å¸ƒå±€
        window.addEventListener('resize', () => {
            if (gameState.currentLevel === 1) {
                createReefs();
            } else if (gameState.currentLevel === 2) {
                createWhirlpools();
            }
        });
    </script>
</body>
</html>